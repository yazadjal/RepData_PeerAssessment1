---
title: "RR_project1"
author: "Yazad Jal"
output: html_document
---
 
Downloading the zipfile from the web and saving it in the working directory

```{r file_download, message=FALSE, warning=FALSE}
fileurl <- "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
destfile <- paste0(getwd(),"/","activity_data.zip")
download.file(fileurl, destfile, method = "curl", quiet = TRUE)
```

Unziping the downloaded file and getting a feel for the data:

```{r data_feel}
unzip("activity_data.zip")
activity <- read.csv("activity.csv")
str(activity)
```

To calculate total number steps per day, I created a new data frame called totalsteps and then made a histogram. 

```{r totalsteps}
totalsteps<-aggregate(steps~date,data=activity,sum,na.rm=TRUE)
hist(totalsteps$steps, 
        col = "royalblue", border = "royalblue", density = 50,
        xlab = "Number of Steps", main = "Total steps per day",
        ylim = c(0,30))
```

Calculating the mean and median of the total number of steps taken per day

```{r mean_median}
mn <- mean(totalsteps$steps)
md <- median(totalsteps$steps)
```

```{r, echo=FALSE}
mn2 <- round(mn, digits = 2)
```

Mean = `r as.character(mn2)` and median is `r md`

Five minute intervals and plot
```{r fivemin}
fivemin <- aggregate(steps~interval, data = activity, sum, na.rm=TRUE)
plot(fivemin$interval, fivemin$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(0,12000))
```

Max 5 min interval
```{r max_fivemin}
max <- fivemin[which.max(fivemin$steps),]$interval
max2 <-paste0(0, max)
```

`r max2` is when the max exercise happens.

Imputing using impute function from Hmisc package

```{r, message=FALSE, warning=FALSE}
library(Hmisc, quietly = TRUE)
activityImputed <- activity
activityImputed$steps <- impute(activity$steps, fun=mean)
totalsteps2<-aggregate(steps~date,data=activityImputed,sum,na.rm=TRUE)
```

New mean and Median
```{r}
mn2 <- mean(totalsteps2$steps)
median(totalsteps2$steps)
```
the new mean is `r mn2`

```{r}
fivemin2 <- aggregate(steps~interval, data = activityImputed, sum, na.rm=TRUE)
par(mfrow=c(1,2))
plot(fivemin$interval, fivemin$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(0,12000))
plot(fivemin2$interval, fivemin2$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(0,12000))
plot(fivemin$interval, fivemin$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(0,500),
     xlim=c(0,500))
plot(fivemin2$interval, fivemin2$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(0,500),
     xlim = c(0,500))
par(mfrow=c(1,1))
```

Instead lets impute on using kNN from the package VIM
```{r, message=FALSE, warning=FALSE, cache=TRUE}
library(VIM)
act <- activity
knnact <- kNN(act)
fivemin3 <- aggregate(steps~interval, data = knnact, sum, na.rm=TRUE)
```

replotting

```{r}
par(mfrow=c(1,2))
plot(fivemin$interval, fivemin$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(0,12000))
plot(fivemin3$interval, fivemin3$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(0,12000))
plot(fivemin$interval, fivemin$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(2000,5000),
     xlim=c(700,800))
plot(fivemin3$interval, fivemin3$steps, type = "l", col = "blue", 
     xlab="Hour of Day", ylab="Number of Steps", 
     main="Average Daily Activity Pattern", ylim = c(2000,5000),
     xlim = c(700,800))
par(mfrow=c(1,1))
```

Lets check if the mean and median remain the same
```{r}
totalsteps3<-aggregate(steps~date,data=knnact,sum,na.rm=TRUE)
mean(totalsteps3$steps)
median(totalsteps3$steps)
```

new mean is `r round(mean(totalsteps3$steps), digits = 0)`, old mean was `r round(mn, digits = 0)` -- the mean has decreased significantly by x%



